{"is_source_file": true, "format": "Python", "description": "This file defines Django ORM models related to user profiles and bookings for a train booking system. It includes classes for user profile data, booking details, and a legacy payment transaction model, along with methods for wallet management and payment processing.", "external_files": ["django.db.models", "django.contrib.auth.models.User", "decimal.Decimal"], "external_methods": ["models.CharField", "models.PositiveIntegerField", "models.DecimalField", "models.BooleanField", "models.DateField", "models.DateTimeField", "models.TextField", "models.JSONField", "models.OneToOneField", "models.ForeignKey", "models.Model", "models.Choices", "models.CharField.max_length", "models.PositiveIntegerField", "models.DecimalField.max_digits", "models.DecimalField.decimal_places", "models.BooleanField.default", "models.DateField", "models.DateTimeField.auto_now_add", "models.TextField.blank", "models.TextField.null", "models.CharField.blank", "models.CharField.null", "models.JSONField.blank", "models.JSONField.null", "models.CharField.max_length", "models.CharField.choices", "models.CharField.default", "models.PositiveIntegerField", "models.DecimalField.default", "models.BooleanField.default", "models.DateTimeField.blank", "models.DateTimeField.null", "models.CharField.null", "models.CharField.blank", "models.ForeignKey.on_delete", "models.OneToOneField.on_delete", "models.ForeignKey.related_name", "models.OneToOneField.related_name", "models.ForeignKey", "models.OneToOneField"], "published": ["UserProfile", "Booking", "PaymentTransaction"], "classes": [{"name": "UserProfile", "description": "Stores user profile data including personal details, preferred berth, wallet balance, and methods for wallet management and user info representation."}, {"name": "Booking", "description": "Handles individual train bookings with details such as source, destination, passenger info, fare, and payment status. Includes logic for wallet payment attempts."}, {"name": "PaymentTransaction", "description": "Represents payment transactions, mainly legacy Razorpay integration, for recording payment statuses and details."}], "methods": [{"name": "deposit_wallet(self, amount)", "description": "Adds specified amount funds to user's wallet balance.", "scope": "UserProfile", "scopeKind": "class"}, {"name": "bool deduct_wallet(self, amount)", "description": "Attempts to deduct specified amount from user's wallet; returns True if successful.", "scope": "UserProfile", "scopeKind": "class"}, {"name": "bool can_afford(self, amount)", "description": "Checks if user's wallet balance can cover the given amount.", "scope": "UserProfile", "scopeKind": "class"}, {"name": "bool try_pay_via_wallet(self)", "description": "Attempts to pay for the booking from user's wallet, updating payment status if successful.", "scope": "Booking", "scopeKind": "class"}, {"name": "__str__(self)", "description": "Returns string representation of UserProfile or Booking instances.", "scope": "UserProfile", "scopeKind": "class"}], "calls": ["self.save()", "self.user_profile.can_afford()", "self.user_profile.deduct_wallet()", "self.password", "self.payment_time", "self.save()"], "search-terms": ["UserProfile", "Booking", "wallet_balance", "try_pay_via_wallet", "deposit_wallet", "deduct_wallet", "payment_transaction", "PNR", "fare", "payment_status"], "state": 2, "file_id": 8, "knowledge_revision": 49, "git_revision": "756eef19971d9e96ddb6cf129a1482dffdc33ec4", "revision_history": [{"28": "1ee4a38a356272713b6d744916e471d3c147316f"}, {"38": "1ee4a38a356272713b6d744916e471d3c147316f"}, {"49": "756eef19971d9e96ddb6cf129a1482dffdc33ec4"}], "ctags": [{"_type": "tag", "name": "Booking", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^class Booking(models.Model):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "PaymentTransaction", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^class PaymentTransaction(models.Model):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "UserProfile", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^class UserProfile(models.Model):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "__str__", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    def __str__(self):$/", "language": "Python", "kind": "member", "signature": "(self)", "scope": "Booking", "scopeKind": "class"}, {"_type": "tag", "name": "__str__", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    def __str__(self):$/", "language": "Python", "kind": "member", "signature": "(self)", "scope": "PaymentTransaction", "scopeKind": "class"}, {"_type": "tag", "name": "__str__", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    def __str__(self):$/", "language": "Python", "kind": "member", "signature": "(self)", "scope": "UserProfile", "scopeKind": "class"}, {"_type": "tag", "name": "address", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    address = models.CharField(max_length=256)$/", "language": "Python", "kind": "variable", "scope": "UserProfile", "scopeKind": "class"}, {"_type": "tag", "name": "age", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    age = models.PositiveIntegerField()$/", "language": "Python", "kind": "variable", "scope": "UserProfile", "scopeKind": "class"}, {"_type": "tag", "name": "amount", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    amount = models.DecimalField(max_digits=8, decimal_places=2)$/", "language": "Python", "kind": "variable", "scope": "PaymentTransaction", "scopeKind": "class"}, {"_type": "tag", "name": "auto_fill_enabled", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    auto_fill_enabled = models.BooleanField(default=True)$/", "language": "Python", "kind": "variable", "scope": "UserProfile", "scopeKind": "class"}, {"_type": "tag", "name": "booking", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    booking = models.OneToOneField(Booking, on_delete=models.CASCADE, related_name='payment', bl/", "language": "Python", "kind": "variable", "scope": "PaymentTransaction", "scopeKind": "class"}, {"_type": "tag", "name": "booking_status", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    booking_status = models.CharField($/", "language": "Python", "kind": "variable", "scope": "Booking", "scopeKind": "class"}, {"_type": "tag", "name": "booking_time", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    booking_time = models.DateTimeField(auto_now_add=True)$/", "language": "Python", "kind": "variable", "scope": "Booking", "scopeKind": "class"}, {"_type": "tag", "name": "can_afford", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    def can_afford(self, amount) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "member", "signature": "(self, amount)", "scope": "UserProfile", "scopeKind": "class"}, {"_type": "tag", "name": "created_at", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    created_at = models.DateTimeField(auto_now_add=True)$/", "language": "Python", "kind": "variable", "scope": "PaymentTransaction", "scopeKind": "class"}, {"_type": "tag", "name": "deduct_wallet", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    def deduct_wallet(self, amount) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "member", "signature": "(self, amount)", "scope": "UserProfile", "scopeKind": "class"}, {"_type": "tag", "name": "deposit_wallet", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    def deposit_wallet(self, amount):$/", "language": "Python", "kind": "member", "signature": "(self, amount)", "scope": "UserProfile", "scopeKind": "class"}, {"_type": "tag", "name": "destination", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    destination = models.CharField(max_length=60)$/", "language": "Python", "kind": "variable", "scope": "Booking", "scopeKind": "class"}, {"_type": "tag", "name": "fare", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    fare = models.DecimalField(max_digits=8, decimal_places=2, default=Decimal('0.00'))$/", "language": "Python", "kind": "variable", "scope": "Booking", "scopeKind": "class"}, {"_type": "tag", "name": "feedback", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    feedback = models.TextField(blank=True, null=True)$/", "language": "Python", "kind": "variable", "scope": "Booking", "scopeKind": "class"}, {"_type": "tag", "name": "full_name", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    full_name = models.CharField(max_length=100)$/", "language": "Python", "kind": "variable", "scope": "UserProfile", "scopeKind": "class"}, {"_type": "tag", "name": "journey_date", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    journey_date = models.DateField()$/", "language": "Python", "kind": "variable", "scope": "Booking", "scopeKind": "class"}, {"_type": "tag", "name": "order_id", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    order_id = models.CharField(max_length=64, blank=True, null=True)$/", "language": "Python", "kind": "variable", "scope": "PaymentTransaction", "scopeKind": "class"}, {"_type": "tag", "name": "paid", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    paid = models.BooleanField(default=False)$/", "language": "Python", "kind": "variable", "scope": "Booking", "scopeKind": "class"}, {"_type": "tag", "name": "paid_via_wallet", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    paid_via_wallet = models.BooleanField(default=False)$/", "language": "Python", "kind": "variable", "scope": "Booking", "scopeKind": "class"}, {"_type": "tag", "name": "passenger_age", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    passenger_age = models.PositiveIntegerField()$/", "language": "Python", "kind": "variable", "scope": "Booking", "scopeKind": "class"}, {"_type": "tag", "name": "passenger_name", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    passenger_name = models.CharField(max_length=100)$/", "language": "Python", "kind": "variable", "scope": "Booking", "scopeKind": "class"}, {"_type": "tag", "name": "passenger_sex", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    passenger_sex = models.CharField(max_length=10)$/", "language": "Python", "kind": "variable", "scope": "Booking", "scopeKind": "class"}, {"_type": "tag", "name": "payment_id", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    payment_id = models.CharField(max_length=64, blank=True, null=True)$/", "language": "Python", "kind": "variable", "scope": "PaymentTransaction", "scopeKind": "class"}, {"_type": "tag", "name": "payment_response", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    payment_response = models.JSONField(blank=True, null=True)$/", "language": "Python", "kind": "variable", "scope": "PaymentTransaction", "scopeKind": "class"}, {"_type": "tag", "name": "payment_time", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    payment_time = models.DateTimeField(blank=True, null=True)$/", "language": "Python", "kind": "variable", "scope": "Booking", "scopeKind": "class"}, {"_type": "tag", "name": "pnr", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    pnr = models.CharField(max_length=20, blank=True, null=True)$/", "language": "Python", "kind": "variable", "scope": "Booking", "scopeKind": "class"}, {"_type": "tag", "name": "preferred_berth", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    preferred_berth = models.CharField($/", "language": "Python", "kind": "variable", "scope": "Booking", "scopeKind": "class"}, {"_type": "tag", "name": "preferred_berth", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    preferred_berth = models.CharField(max_length=16, choices=($/", "language": "Python", "kind": "variable", "scope": "UserProfile", "scopeKind": "class"}, {"_type": "tag", "name": "source", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    source = models.CharField(max_length=60)$/", "language": "Python", "kind": "variable", "scope": "Booking", "scopeKind": "class"}, {"_type": "tag", "name": "status", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    status = models.CharField($/", "language": "Python", "kind": "variable", "scope": "PaymentTransaction", "scopeKind": "class"}, {"_type": "tag", "name": "try_pay_via_wallet", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    def try_pay_via_wallet(self) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "member", "signature": "(self)", "scope": "Booking", "scopeKind": "class"}, {"_type": "tag", "name": "user", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    user = models.OneToOneField(User, on_delete=models.CASCADE, related_name='profile')$/", "language": "Python", "kind": "variable", "scope": "UserProfile", "scopeKind": "class"}, {"_type": "tag", "name": "user_profile", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    user_profile = models.ForeignKey(UserProfile, on_delete=models.CASCADE, related_name='bookin/", "language": "Python", "kind": "variable", "scope": "Booking", "scopeKind": "class"}, {"_type": "tag", "name": "wallet_balance", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/models.py", "pattern": "/^    wallet_balance = models.DecimalField(max_digits=10, decimal_places=2, default=Decimal(\"0.00\"/", "language": "Python", "kind": "variable", "scope": "UserProfile", "scopeKind": "class"}], "hash": "9f5b1e77b34fb4934ccfc6d3027aa07b", "format-version": 4, "code-base-name": "backend", "filename": "backend/api/models.py", "fields": [{"name": "address = models.CharField(max_length=256)", "scope": "UserProfile", "scopeKind": "class", "description": "unavailable"}, {"name": "age = models.PositiveIntegerField()", "scope": "UserProfile", "scopeKind": "class", "description": "unavailable"}, {"name": "amount = models.DecimalField(max_digits=8, decimal_places=2)", "scope": "PaymentTransaction", "scopeKind": "class", "description": "unavailable"}, {"name": "auto_fill_enabled = models.BooleanField(default=True)", "scope": "UserProfile", "scopeKind": "class", "description": "unavailable"}, {"name": "booking = models.OneToOneField(Booking, on_delete=models.CASCADE, related_name='payment', bl/", "scope": "PaymentTransaction", "scopeKind": "class", "description": "unavailable"}, {"name": "booking_status = models.CharField(", "scope": "Booking", "scopeKind": "class", "description": "unavailable"}, {"name": "booking_time = models.DateTimeField(auto_now_add=True)", "scope": "Booking", "scopeKind": "class", "description": "unavailable"}, {"name": "created_at = models.DateTimeField(auto_now_add=True)", "scope": "PaymentTransaction", "scopeKind": "class", "description": "unavailable"}, {"name": "destination = models.CharField(max_length=60)", "scope": "Booking", "scopeKind": "class", "description": "unavailable"}, {"name": "fare = models.DecimalField(max_digits=8, decimal_places=2, default=Decimal('0.00'))", "scope": "Booking", "scopeKind": "class", "description": "unavailable"}, {"name": "feedback = models.TextField(blank=True, null=True)", "scope": "Booking", "scopeKind": "class", "description": "unavailable"}, {"name": "full_name = models.CharField(max_length=100)", "scope": "UserProfile", "scopeKind": "class", "description": "unavailable"}, {"name": "journey_date = models.DateField()", "scope": "Booking", "scopeKind": "class", "description": "unavailable"}, {"name": "order_id = models.CharField(max_length=64, blank=True, null=True)", "scope": "PaymentTransaction", "scopeKind": "class", "description": "unavailable"}, {"name": "paid = models.BooleanField(default=False)", "scope": "Booking", "scopeKind": "class", "description": "unavailable"}, {"name": "paid_via_wallet = models.BooleanField(default=False)", "scope": "Booking", "scopeKind": "class", "description": "unavailable"}, {"name": "passenger_age = models.PositiveIntegerField()", "scope": "Booking", "scopeKind": "class", "description": "unavailable"}, {"name": "passenger_name = models.CharField(max_length=100)", "scope": "Booking", "scopeKind": "class", "description": "unavailable"}, {"name": "passenger_sex = models.CharField(max_length=10)", "scope": "Booking", "scopeKind": "class", "description": "unavailable"}, {"name": "payment_id = models.CharField(max_length=64, blank=True, null=True)", "scope": "PaymentTransaction", "scopeKind": "class", "description": "unavailable"}, {"name": "payment_response = models.JSONField(blank=True, null=True)", "scope": "PaymentTransaction", "scopeKind": "class", "description": "unavailable"}, {"name": "payment_time = models.DateTimeField(blank=True, null=True)", "scope": "Booking", "scopeKind": "class", "description": "unavailable"}, {"name": "pnr = models.CharField(max_length=20, blank=True, null=True)", "scope": "Booking", "scopeKind": "class", "description": "unavailable"}, {"name": "preferred_berth = models.CharField(", "scope": "Booking", "scopeKind": "class", "description": "unavailable"}, {"name": "preferred_berth = models.CharField(max_length=16, choices=(", "scope": "UserProfile", "scopeKind": "class", "description": "unavailable"}, {"name": "source = models.CharField(max_length=60)", "scope": "Booking", "scopeKind": "class", "description": "unavailable"}, {"name": "status = models.CharField(", "scope": "PaymentTransaction", "scopeKind": "class", "description": "unavailable"}, {"name": "user = models.OneToOneField(User, on_delete=models.CASCADE, related_name='profile')", "scope": "UserProfile", "scopeKind": "class", "description": "unavailable"}, {"name": "user_profile = models.ForeignKey(UserProfile, on_delete=models.CASCADE, related_name='bookin/", "scope": "Booking", "scopeKind": "class", "description": "unavailable"}, {"name": "wallet_balance = models.DecimalField(max_digits=10, decimal_places=2, default=Decimal(\"0.00\"/", "scope": "UserProfile", "scopeKind": "class", "description": "unavailable"}]}
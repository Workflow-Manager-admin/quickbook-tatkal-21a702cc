{"is_source_file": true, "format": "Python (Django REST Framework view module)", "description": "This file contains Django REST Framework API views for user registration, wallet management, booking creation and status, payment integration with Razorpay, user profile management, and specific endpoints for Tatkal railway booking. It implements various endpoints to handle user actions, booking workflows, payment processing, and auto-fill suggestions.", "external_files": ["rest_framework.decorators", "rest_framework.permissions", "rest_framework.response", "rest_framework.status", "django.contrib.auth.models.User", "./models", "./serializers", "django.db.transaction", "random", "string"], "external_methods": ["User.objects.filter", "User.objects.create_user", "User.objects.get", "UserProfile.objects.create", "UserProfile.objects.get", "UserProfile.objects.all", "Booking.objects.filter", "Booking.objects.get", "PaymentTransaction.objects.create", "PaymentTransaction.objects.get"], "published": ["register_user", "deposit_wallet", "create_booking", "get_profile", "get_bookings", "health", "user_profile_list_create", "user_profile_detail", "tatkal_booking_create", "tatkal_booking_status", "tatkal_booking_cancel", "auto_fill_suggestions", "payment_initiate", "payment_callback", "payment_status"], "classes": [], "methods": [{"name": "register_user(request)", "description": "Registers a new user and creates a UserProfile; expects user details in POST data.", "scope": "", "scopeKind": ""}, {"name": "deposit_wallet(request)", "description": "Deposits funds into a user's wallet, updating the profile's wallet balance.", "scope": "", "scopeKind": ""}, {"name": "create_booking(request)", "description": "Creates a new booking; attempts auto-debit from wallet if sufficient balance.", "scope": "", "scopeKind": ""}, {"name": "get_profile(request, user_id)", "description": "Retrieves the UserProfile data for a given user ID.", "scope": "", "scopeKind": ""}, {"name": "get_bookings(request, user_id)", "description": "Fetches all bookings associated with a user profile.", "scope": "", "scopeKind": ""}, {"name": "health(request)", "description": "API health check endpoint.", "scope": "", "scopeKind": ""}, {"name": "user_profile_list_create(request)", "description": "Handles GET to list profiles or POST to create a new profile.", "scope": "", "scopeKind": ""}, {"name": "user_profile_detail(request, user_id)", "description": "Retrieves, updates, or deletes a specific user profile.", "scope": "", "scopeKind": ""}, {"name": "tatkal_booking_create(request)", "description": "Creates a Tatkal booking with validation feedback.", "scope": "", "scopeKind": ""}, {"name": "tatkal_booking_status(request, booking_id)", "description": "Checks the status of a specific booking by ID.", "scope": "", "scopeKind": ""}, {"name": "tatkal_booking_cancel(request, booking_id)", "description": "Cancels an existing booking if allowed.", "scope": "", "scopeKind": ""}, {"name": "auto_fill_suggestions(request, user_profile_id)", "description": "Provides or updates auto-fill profile data for forms.", "scope": "", "scopeKind": ""}, {"name": "payment_initiate(request)", "description": "Initiates a mock payment session for a booking, providing order ID and payment URL.", "scope": "", "scopeKind": ""}, {"name": "payment_callback(request)", "description": "Handles payment callback, updates booking/payment statuses, and generates PNR if successful.", "scope": "", "scopeKind": ""}, {"name": "payment_status(request, payment_transaction_id)", "description": "Returns payment transaction status details.", "scope": "", "scopeKind": ""}], "calls": ["User.objects.filter", "User.objects.create_user", "User.objects.get", "UserProfile.objects.create", "UserProfile.objects.get", "UserProfile.objects.all", "Booking.objects.filter", "Booking.objects.get", "PaymentTransaction.objects.create", "PaymentTransaction.objects.get", "transaction.atomic", "random.choices", "string.ascii_lowercase", "string.digits"], "search-terms": ["Tatkal booking", "wallet deposit", "payment callback", "auto-fill profile", "booking creation", "payment initiation", "booking cancellation", "user registration", "profile management", "payment transaction"], "state": 2, "file_id": 9, "knowledge_revision": 58, "git_revision": "2950d5b53ce19b1e795001e3c33d55a95084fb10", "revision_history": [{"26": "1ee4a38a356272713b6d744916e471d3c147316f"}, {"41": "1ee4a38a356272713b6d744916e471d3c147316f"}, {"47": "756eef19971d9e96ddb6cf129a1482dffdc33ec4"}, {"54": "756eef19971d9e96ddb6cf129a1482dffdc33ec4"}, {"57": "756eef19971d9e96ddb6cf129a1482dffdc33ec4"}, {"58": "2950d5b53ce19b1e795001e3c33d55a95084fb10"}], "ctags": [{"_type": "tag", "name": "RAZORPAY_MOCK_KEY", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/views.py", "pattern": "/^RAZORPAY_MOCK_KEY = \"rzp_test_mocked\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "RAZORPAY_MOCK_SECRET", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/views.py", "pattern": "/^RAZORPAY_MOCK_SECRET = \"secret_key_mocked\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "auto_fill_suggestions", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/views.py", "pattern": "/^def auto_fill_suggestions(request, user_profile_id):$/", "language": "Python", "kind": "function", "signature": "(request, user_profile_id)"}, {"_type": "tag", "name": "create_booking", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/views.py", "pattern": "/^def create_booking(request):$/", "language": "Python", "kind": "function", "signature": "(request)"}, {"_type": "tag", "name": "deposit_wallet", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/views.py", "pattern": "/^def deposit_wallet(request):$/", "language": "Python", "kind": "function", "signature": "(request)"}, {"_type": "tag", "name": "drf_status", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/views.py", "pattern": "/^from rest_framework import status as drf_status$/", "language": "Python", "kind": "unknown", "nameref": "unknown:status"}, {"_type": "tag", "name": "get_bookings", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/views.py", "pattern": "/^def get_bookings(request, user_id):$/", "language": "Python", "kind": "function", "signature": "(request, user_id)"}, {"_type": "tag", "name": "get_profile", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/views.py", "pattern": "/^def get_profile(request, user_id):$/", "language": "Python", "kind": "function", "signature": "(request, user_id)"}, {"_type": "tag", "name": "health", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/views.py", "pattern": "/^def health(request):$/", "language": "Python", "kind": "function", "signature": "(request)"}, {"_type": "tag", "name": "payment_callback", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/views.py", "pattern": "/^def payment_callback(request):$/", "language": "Python", "kind": "function", "signature": "(request)"}, {"_type": "tag", "name": "payment_initiate", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/views.py", "pattern": "/^def payment_initiate(request):$/", "language": "Python", "kind": "function", "signature": "(request)"}, {"_type": "tag", "name": "payment_status", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/views.py", "pattern": "/^def payment_status(request, payment_transaction_id):$/", "language": "Python", "kind": "function", "signature": "(request, payment_transaction_id)"}, {"_type": "tag", "name": "register_user", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/views.py", "pattern": "/^def register_user(request):$/", "language": "Python", "kind": "function", "signature": "(request)"}, {"_type": "tag", "name": "tatkal_booking_cancel", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/views.py", "pattern": "/^def tatkal_booking_cancel(request, booking_id):$/", "language": "Python", "kind": "function", "signature": "(request, booking_id)"}, {"_type": "tag", "name": "tatkal_booking_create", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/views.py", "pattern": "/^def tatkal_booking_create(request):$/", "language": "Python", "kind": "function", "signature": "(request)"}, {"_type": "tag", "name": "tatkal_booking_status", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/views.py", "pattern": "/^def tatkal_booking_status(request, booking_id):$/", "language": "Python", "kind": "function", "signature": "(request, booking_id)"}, {"_type": "tag", "name": "user_profile_detail", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/views.py", "pattern": "/^def user_profile_detail(request, user_id):$/", "language": "Python", "kind": "function", "signature": "(request, user_id)"}, {"_type": "tag", "name": "user_profile_list_create", "path": "/home/kavia/workspace/code-generation/quickbook-tatkal-21a702cc/backend/api/views.py", "pattern": "/^def user_profile_list_create(request):$/", "language": "Python", "kind": "function", "signature": "(request)"}], "hash": "6f6ddd8290260254d60b7b1398702835", "format-version": 4, "code-base-name": "backend", "filename": "backend/api/views.py", "fields": [{"name": "RAZORPAY_MOCK_KEY = \"rzp_test_mocked\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "RAZORPAY_MOCK_SECRET = \"secret_key_mocked\"", "scope": "", "scopeKind": "", "description": "unavailable"}]}